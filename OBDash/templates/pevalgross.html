{% extends 'base.html' %}

{% block content %}
{% load static %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<div class="evaluation-container">
    <div class="back-button-container">
        <a href="{% url 'dashboard' %}" class="back-button">
            <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
    </div>

    <h1 class="domain-title">Gross Motor Domain</h1>
    
    <!-- Include the domain navigation -->
    {% include 'domain_nav.html' with active_domain='gross' %}
    
    <div class="evaluation-table">
        <table>
            <thead>
                <tr>
                    <th class="gross-motor-col">Gross Motor</th>
                    <th class="material-col">Material / Procedure</th>
                    <th class="eval-col">1st Eval</th>
                    <th class="eval-col">2nd Eval</th>
                    <th class="eval-col">3rd Eval</th>
                    <th class="comments-col">Comments</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1. Climbs on the chair or other elevated furniture like a bed without a help</td>
                    <td>Parental report will suffice.</td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                    <td><input type="text" class="comment-input"></td>
                </tr>
                <tr>
                    <td>2. Walks downstairs, 2 feet on each step, with one handheld</td>
                    <td>
                        MATERIAL: toy<br>
                        PROCEDURE: Ask the child to walk backwards by demonstrating this. Credit if the child is able to walk backwards without falling and holding anything. Parental report will suffice.
                    </td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                    <td><input type="text" class="comment-input"></td>
                </tr>
                <tr>
                    <td>3. Dances patterns/joins group movement activities</td>
                    <td>
                        MATERIAL: ball<br>
                        PROCEDURE: Encourage the child to run by rolling a ball across the floor. Credit if the child can run past and without tripping or falling.
                    </td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                    <td><input type="text" class="comment-input"></td>
                </tr>
                <tr>
                    <td>--</td>
                    <td colspan="1" class="total-row">TOTAL SCORE</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    
                </tr>
            </tbody>
        </table>
    </div>
</div>

<style>
.back-button-container {
    margin-bottom: 1rem;
}

.back-button {
    display: inline-flex;
    align-items: center;
    padding: 0.5rem 1rem;
    background-color: #2d6a4f;
    color: white;
    text-decoration: none;
    border-radius: 5px;
    transition: background-color 0.3s ease;
    font-weight: 500;
}

.back-button:hover {
    background-color: #1b4332;
    color: white;
}

.back-button i {
    margin-right: 0.5rem;
}

.evaluation-container {
    padding: 2rem;
    max-width: 1400px;
    margin: 0 auto;
}

.domain-title {
    color: #2d6a4f;
    margin-bottom: 2rem;
    font-size: 2rem;
    font-weight: 600;
}

.evaluation-table {
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    overflow-x: auto;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th, td {
    padding: 1rem;
    border: 1px solid #e0e0e0;
    text-align: left;
}

th {
    background-color: #2d6a4f;
    color: white;
    font-weight: 500;
}

.gross-motor-col {
    width: 25%;
}

.material-col {
    width: 30%;
}

.eval-col {
    width: 8%;
    text-align: center;
}

.comments-col {
    width: 21%;
}

input[type="checkbox"] {
    width: 20px;
    height: 20px;
    cursor: pointer;
}

.comment-input {
    width: 100%;
    padding: 0.5rem;
    border: 1px solid #ddd;
    border-radius: 4px;
}

.total-row {
    font-weight: 600;
    background-color: #f8f9fa;
}

tr:hover {
    background-color: #f8f9fa;
}

@media (max-width: 768px) {
    .back-button {
        font-size: 0.9rem;
        padding: 0.4rem 0.8rem;
    }
    
    .evaluation-container {
        padding: 1rem;
    }
    
    th, td {
        padding: 0.5rem;
        font-size: 0.9rem;
    }
}

td {
    transition: background-color 0.3s ease;
}

tr:last-child td {
    transition: background-color 0.3s ease;
}

input[type="checkbox"] {
    width: 20px;
    height: 20px;
    cursor: pointer;
    accent-color: #2d6a4f;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    function countCheckedBoxes(columnIndex) {
        let count = 0;
        const rows = document.querySelectorAll('tbody tr:not(:last-child)');
        rows.forEach(row => {
            const checkbox = row.querySelector(`td:nth-child(${columnIndex}) input[type="checkbox"]`);
            if (checkbox && checkbox.checked) {
                count++;
            }
        });
        return count;
    }

    function updateTotalScore() {
        // Get the total row cells
        const totalRow = document.querySelector('tbody tr:last-child');
        
        // Count and update for each evaluation column
        const firstEvalTotal = countCheckedBoxes(3);  // 3rd column (1st Eval)
        const secondEvalTotal = countCheckedBoxes(4); // 4th column (2nd Eval)
        const thirdEvalTotal = countCheckedBoxes(5);  // 5th column (3rd Eval)

        // Update the total cells
        totalRow.cells[2].textContent = firstEvalTotal;
        totalRow.cells[3].textContent = secondEvalTotal;
        totalRow.cells[4].textContent = thirdEvalTotal;

        // Add animation effect
        [2, 3, 4].forEach(index => {
            totalRow.cells[index].style.backgroundColor = '#e8f5e9';
            setTimeout(() => {
                totalRow.cells[index].style.backgroundColor = '';
            }, 500);
        });
    }

    // Add event listeners to checkboxes
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
            // Highlight the cell when checked
            const cell = this.parentElement;
            cell.style.backgroundColor = this.checked ? '#e8f5e9' : '';
            
            // Update the totals
            updateTotalScore();
        });
    });

    // Initialize totals on page load
    updateTotalScore();
});
</script>
{% endblock %}